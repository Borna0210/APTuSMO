from Exploiting.hydra import hydra_crack
from Exploiting.metasploit import run_metasploit
from Exploiting.sqlmap import run_sqlmap_from_input
from Exploiting.xss_strike import run_xss_strike
from Exploiting.wafninja_bypass import wafninja_bypass


def run_exploits(target, test_type, hosts=[], source="127.0.0.1",hid=0,uname='',passlist='',lservices=[]):
    print("Starting the exploiting phase")
    wafninja_bypass(target)
    if(len(hosts)>0):
      run_sqlmap_from_input(hosts)
    else:
      run_sqlmap_from_input(target)
    run_xss_strike()
    if (test_type=="web"):
      run_metasploit(target, source, "web", hosts)
    else:
      if(hid==1):
        hydra_crack(uname,passlist,lservices, hosts)
      run_metasploit(target, source, "net", hosts)
    print("Finished the Exploiting phase")

    
