import subprocess

def scan_directory_with_clamav(directory='none'):
    directories_to_scan = [
        "/home",
        "/tmp",
        "/var/tmp",
        "/var/www",  # Adjust based on your web server
        "/usr/share/nginx/html",  # Adjust based on your web server
        "/var/mail",
        "/var/spool/mail",
        "/usr/local/bin",
        "/usr/bin",
        "/bin",
        "/sbin",
        "/usr/sbin"
    ]
    results = ""
    if directory != 'none':
        directories_to_scan = [directory]
    
    for dir_to_scan in directories_to_scan:
        try:
            result = subprocess.run(['clamscan', '-r', dir_to_scan], capture_output=True, text=True)
            results += f"Scan results for {dir_to_scan}:\n{result.stdout}\n"
        except subprocess.SubprocessError as e:
            results += f"Error during scan of {dir_to_scan}: {str(e)}\n"
    
    return results

